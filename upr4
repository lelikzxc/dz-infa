import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
from sklearn.linear_model import LinearRegression

iris_data = pd.read_csv("iris_data.csv")

features = ["SepalLengthCm", "SepalWidthCm", "PetalLengthCm", "PetalWidthCm"]
combinations = [(x, y) for x in features for y in features if x != y]

for x, y in combinations:
    sns.lmplot(x=x, y=y, data=iris_data, hue="Species")
    plt.title(f"Зависимость {y} от {x}")
    plt.show()

    X = iris_data[[x]].values
    Y = iris_data[[y]].values
    model = LinearRegression()
    model.fit(X, Y)

    print(f"Уравнение линейной регрессии: {y} = {model.intercept_[0]:.2f} + {model.coef_[0][0]:.2f} * {x}")
    print(f"Коэффициент детерминации: {model.score(X, Y):.2f}")

